/** 
* Universidad de Colima
* custom.min.js
* V2.0
* @pfernandez@ucol.mx
*/
var heightHeader = $( 'nav.navbar' ).height(); //obtiene altura de header
var anclaInterna = $( 'a[href^="#"]' ); //obtiene ancla desde un link
var anclaUrl = window.location.hash; //obtiene ancla desde la url
    
jQuery(document).ready(function($) {
    $('ul.main-navigation li').children('ul.sub-nav').hide();
    $('ul.main-navigation li ').hover(function() {
        $(this).children('ul.sub-nav').stop(true, true).fadeIn({
            duration: 400,
            easing: 'easeInSine'
        });
    }, function() {
        $(this).children('ul.sub-nav').stop(true, true).fadeOut({
            duration: 400,
            easing: 'easeOutSine'
        });
    });
    $('ul.sub-nav li').children('ul.sub-sub-nav').hide();
    $('ul.sub-nav li').hover(function() {
        $(this).children('ul.sub-sub-nav').stop(true, true).fadeIn({
            duration: 400,
            easing: 'easeInSine'
        });
    }, function() {
        $(this).children('ul.sub-sub-nav').stop(true, true).fadeOut({
            duration: 400,
            easing: 'easeOutSine'
        });
    });
    $('ul.main-navigation li ul').hover(function() {
        $(this).parent('li').children('a').addClass('active');
    }, function() {
        $(this).parent('li').children('a').removeClass('active');
    });
    $('ul.sub-nav li, ul.sub-sub-nav li').hover(function() {
        $(this).children('a').stop(true, true).animate({
            backgroundColor: '#322e39'
        })
    }, function() {
        $(this).children('a').stop(true, true).animate({
            backgroundColor: '#fe8a02'
        });
    });
    $(".responsive-menu select").change(function() {
        window.location = $(this).find("option:selected").val();
    });
    //slider principal
    $("#slider3").responsiveSlides({
        auto: true,
        pager: true,
        pause: true, //pausar el slider 
        nav: true,
        timeout: 6000,
        speed: 800
    });
    $("#slider2").responsiveSlides({
        auto: true,
        pager: false,
        nav: true,
        timeout: 6000,
        speed: 800
    });
    $("#slidePortafolio").responsiveSlides({
	    auto: true,
        pager: false,
        nav: true,
        timeout: 6000,
        speed: 800,
        random: true
	});

    $('a.rslides_nav.prev, a.rslides_nav.next').fadeTo('fast', 0.2);
    $('a.rslides_nav.prev, a.rslides_nav.next').hover(function() {
        $(this).stop(true, true).fadeTo('slow', 1);
    }, function() {
        $(this).stop(true, true).fadeTo('slow', 0.2);
    });
    $('.featured-icon a').hover(function() {
        $(this).stop(true, true).animate({
            color: '#fe8a02'
        })
    }, function() {
        $(this).stop(true, true).animate({
            color: '#c2c2c2'
        })
    });
    $('ul.social-icons li a.icon.social').hover(function() {
        $(this).stop(true, true).addClass('active', 600);
    }, function() {
        $(this).stop(true, true).removeClass('active', 600);
    });
    
    
    /** 
    *  Botón para regresar al inicio del documento
    * @pfernandez@ucol.mx
    */
    $( '.scrollup' ).hover( function() {
        $( this ).stop( true, true ).animate({
            background: '-21px 21px'
        })
    }, function() {
        $( this ).stop( true, true ).animate({
            background: '0px 0px'
        })
    });
    $( window ).scroll( function() {
        if ( $( this ).scrollTop() > 300 ) {
            $( '.scrollup' ).fadeIn();
        } else {
            $( '.scrollup' ).fadeOut();
        }
    });
    $( '.scrollup' ).click( function() {
        $( 'html, body' ).animate({
            scrollTop: 0
        }, 600 );
        return false;
    });
   
    //---------------------------------------------------------------------------------------------------------------------
    
    $('span.team-button').hover(function() {
        $(this).stop(true, true).animate({
            backgroundColor: '#322e39'
        })
    }, function() {
        $(this).stop(true, true).animate({
            backgroundColor: '#fe8a02'
        })
    });
    $('.team-content').hide();
    $('span.team-button').text(':');
    $('span.team-button').click(function() {
        $(this).parent('.image-holder').children('img, .team-content').stop(true, true).slideToggle({
            duration: 600,
            easing: 'linear'
        });
        $(this).parent('.image-holder').children('span.team-button').text($(this).text() == ':' ? ';' : ':');
    });
    var $container_accordion = $('.accordion > div'),
        $trigger = $('.accordion > h6');
    $container_accordion.hide();
    $trigger.first().addClass('active').next().show();
    $trigger.on('click', function(e) {
        if ($(this).next().is(':hidden')) {
            $trigger.removeClass('active').next().slideUp(300);
            $(this).toggleClass('active').next().slideDown(300);
        }
        e.preventDefault();
    });
    $('.tab-filter').each(function() {
        var $active, $content, $links = $(this).find('a');
        $active = $links.first().addClass('active');
        $content = $($active.attr('href'));
        $links.not(':first').each(function() {
            $($(this).attr('href')).hide();
        });
        $(this).on('click', 'a', function(e) {
            $active.removeClass('active');
            $content.hide();
            $active = $(this);
            $content = $($(this).attr('href'));
            $active.addClass('active');
            $content.show();
            e.preventDefault();
        });
    });
    $('.tags-widget ul li a').hover(function() {
        $(this).stop(true, true).animate({
            'backgroundColor': '#322e39',
            duration: 400,
            easing: 'easeOutSine'
        })
    }, function() {
        $(this).stop(true, true).animate({
            'backgroundColor': '#fe8a02',
            duration: 400,
            easing: 'easeOutSine'
        })
    });
    
	/** 
    *  Ampliar imagen ( solo funciona dentro del enterate )
    * @pfernandez@ucol.mx
    */
    $('.art_contenido').append('<div class="popup-image"></div><div id="mask"></div> ');
    $('.art_contenido .popupimage').on('click', function() {
        var $imgsrc = $(this).attr('src');
        $('#mask').css({
            'visibility': 'visible',
            'opacity': '0.8'
        });
        $('.popup-image').css({
            'background-image': 'url( "' + $imgsrc + '" )',
            'visibility': 'visible',
            'opacity': '1'
        });
    });
    $('.popup-image').on('click', function() {
        $(this).removeAttr('style');
        $('#mask').removeAttr('style');
    });
    $(document).bind('keydown', function(e) {
        if (e.which == 27) {
            $('.popup-image').removeAttr('style');
            $('#mask').removeAttr('style');
        };
    });
    //---------------------------------------------------------------------------------------------------------------------
    
    $('#sliderNaN>.rslides').responsiveSlides({auto:true,pager:true,nav:true,timeout:6000,speed:800});
	$( function() {
		$('[data-toggle="tooltip"]').tooltip();
	});
	$("#content img").addClass("img-fluid");
    $( '.form-search-ucol' ).click( function() {
		$( this ).addClass( 'active' );
	}).focusout( function() {
		$( this ).removeClass( 'active' );
	});
	
	
			
    
    /** 
    *  Oferta educativa ( oculta reconocimientos solo vacios, funciona dentro de oferta-educativa )
    * @pfernandez@ucol.mx
    */
    var oferta_contenido = $('#oferta-contenido').length;
    try {
	   if(oferta_contenido!=0){
			var recono_cimientos = $('#recono-cimientos .accordion-inner font').html();
			var recono_cimientos2 = $('#recono-cimientos2 .accordion-inner font').html();
			if( recono_cimientos === '<br>' ||  recono_cimientos2 === '<br>' ){
				$('#recono-cimientos').parent().remove();
				$('#recono-cimientos2').parent().remove();
			}
		}
	}
	catch(err) {
	    
	}
    
    
    
   
	
     //---------------------------------------------------------------------------------------------------------------------

    /** 
    *  Traducción -- español / inglés -- de algunas secciones especificadas en un array
    * @pfernandez@ucol.mx
    */
    /*var url = $.url();
    var urlSegmented = $.url().segment();
    console.log(urlSegmented);
    var protocol = url.attr('protocol');
    var host = url.attr('host');
    var segment = url.segment(1);
    var file = url.attr('file');
    var sites = ['rector', 'gobierno-universitario', 'conocenos', 'portal-web', 'desarrollo-institucional', 'becas', 'alumnos', 'marco-filosofico', 'relaciones-internacionales'];
    var sites2 = ['rector-en', 'gobierno-universitario-en', 'conocenos-en', 'portal-web-en', 'desarrollo-institucional-en', 'becas-en', 'alumnos-en', 'marco-filosofico-en', 'relaciones-internacionales-en', 'relaciones-internacionales-fr'];
    $.each(sites, function(i, val) {
	    if (urlSegmented[0] === sites[i] || urlSegmented[0] === sites2[i]) {
	                $('#tidioma').removeClass('hidden');
	    }
    });
    $('#goEN').on('click', function() {
        $.each(sites, function(i, val) {
            if (urlSegmented[0] === sites[i]) {
                window.location.href = protocol + '://' + host + '/' + segment + '/en/' + file;
            } else {
                //alert( 'Esta página aún no cuenta con traducción.' )
            }
        });
    });
    $('#goES').on('click', function() {
        $.each(sites, function(i, val) {
            if (urlSegmented[0] === sites[i]) {
                window.location.href = protocol + '://' + host + '/' + segment + '/' + file;
            }
        });
    });*/
    //---------------------------------------------------------------------------------------------------------------------
    
    /** 
    * Busca refrencia en el documento mediante click desde un ancla en específico
    * @pfernandez@ucol.mx
    */
   /* var spaceUcol = location.pathname;
    if ( spaceUcol = spaceUcol.toLowerCase()) {
	    console.log(spaceUcol);
	    $( anclaInterna ).on( 'click', function() {
		    if ( spaceUcol = spaceUcol.search("/oferta-educativa") <= 0 ) {
			     console.log('estás aquí');
	        } else {
		        console.log(spaceUcol);
	        		var link = $( this );
				var anchor  = link.attr( 'href' );
				console.log(anchor);
				$( 'html, body' ).stop().animate({
					scrollTop: jQuery( anchor ).offset().top - heightHeader
				}, 2000);
				return false; 
	        }
	    	})
    	}*/
    /*$( anclaInterna ).on('click', function(){
        var link = $( this );
        var anchor  = link.attr( 'href' );
        $( 'html, body' ).stop().animate({
            scrollTop: jQuery( anchor ).offset().top - heightHeader
        }, 2000);
        return false;
    });*/
    //---------------------------------------------------------------------------------------------------------------------

		/*EN CASO DE MENU LATERAL ACTIVA EL SELECCIONADO*/
		var url = $(location).attr('pathname');
		url=url.split("/");
		url=url[url.length-1].split(",");
	    $('#navlist li a[href="'+url[0]+'"]').parents("li").addClass('active');
}); //fin de ready function

jQuery( window ).load(  function ( ) {
	/** 
    * Busca refrencia en el documento obtenida a traves de la 
    * @pfernandez@ucol.mx
    */
	$( anclaUrl ).each( function() {
		setTimeout(function() {
	        $( 'html, body' ).stop().animate({
	            scrollTop: jQuery( anclaUrl ).offset().top - heightHeader - 30
	        }, 2000);
	    },1000);
        return false;
	});
	//---------------------------------------------------------------------------------------------------------------------
}); //fin de load function